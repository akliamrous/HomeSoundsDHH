<html>
  <head>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>
	<script src="https://code.highcharts.com/modules/export-data.js"></script>
	<title>Waveform View - Home Sound</title>
  </head>
  
  <body>
    
	<div id="container1" style="width: 90%; min-width: 310px; height: 25%; margin: 20 auto; margin-top: 100"></div>
	<div id="container2" style="width: 90%; min-width: 310px; height: 25%; margin: 20 auto"></div>
	<div id="container3" style="width: 90%; min-width: 310px; height: 25%; margin: 20 auto"></div>
    
    <script> 
	var BEDROOM = "1", LOBBY = "2", KITCHEN = "3";
	var y1 = y2 = y3 = 0;
			
	/**** Data from Socket ****/
      var socket = io.connect();
      socket.on('responseFromHttpServer', function(data){
		  
		  data = JSON.parse(data);
		  
		  if(data.clientid == BEDROOM)
	      {
			y1 = parseFloat(data.dataFromHttpServer);
			console.log("1:" + y1);
		  }
		  
		  else if(data.clientid == LOBBY)
	      {
			y2 = parseFloat(data.dataFromHttpServer);
			console.log("2:" + y2);
		  }
		  	
		  else if(data.clientid == KITCHEN)
	      {
			y3 = parseFloat(data.dataFromHttpServer);
			console.log("3:" + y3);
		  }		
			
	  });

	/**** Charts *****/
	
	/*Bedroom*/
	Highcharts.chart('container1', {
		chart: {
			type: 'areaspline',
			animation: Highcharts.svg, // don't animate in old IE
			marginRight: 10,
			/* Dynamic Data */
			events: {
				load: function () {

					// set up the updating of the chart each second
					var series = this.series[0];
					setInterval(function () {
						var x = (new Date()).getTime(), // current time
							y = y1;
						series.addPoint([x, y], true, true);
					}, 1000);
				}
			}
		},

		time: {
			useUTC: false
		},

		title: {
			text: 'Bedroom',
			align: 'left',
			style: {"font-size": "200%", "color": "#676767"},
			margin: 0,
			x: 30
		},
		xAxis: {
			type: 'datetime',
			tickPixelInterval: 150
		},
		yAxis: {
			gridLineColor: '#ebebeb',
			title: {
				text: undefined
				/*text: 'Bedroom',
				rotation: 0,
				margin: 60,
				style: {"font-family": "Helvetica, Arial, sans-serif", "font-size": "250%", "color": "#676767"}
				*/
			},
			plotLines: [{
				value: 0,
				width: 1,
				color: '#808080'
			}]

		},
		tooltip: {
			headerFormat: '<b>{series.name}</b><br/>',
			//pointFormat: '{point.x:%Y-%m-%d %H:%M:%S}<br/>{point.y:.2f}'
			pointFormat: '{point.x:%H:%M:%S}: {point.y:.2f}'
		},
		legend: {
			enabled: false
		},
		exporting: {
			enabled: false
		},
		plotOptions: {
			areaspline: {
				marker: {
					enabled: false
				},
			}
		},
		/* Initial Data */
		series: [{				
			name: 'Bedroom',
			fillOpacity: 0.2,
			data: (function () {
				// generate an array of random data
				var data = [],
					time = (new Date()).getTime(),
					i;

				for (i = -19; i <= 0; i += 1) {
					data.push({
						x: time + i * 1000,
						y: Math.random()
					});
				}
				return data;
			}())
		}]
	});
	
	/*Lobby*/
	Highcharts.chart('container2', {
		chart: {
			type: 'areaspline',
			animation: Highcharts.svg, // don't animate in old IE
			marginRight: 10,
			/* Dynamic Data */
			events: {
				load: function () {

					// set up the updating of the chart each second
					var series = this.series[0];
					setInterval(function () {
						var x = (new Date()).getTime(), // current time
							y = y2;
						series.addPoint([x, y], true, true);
					}, 1000);
				}
			}
		},

		time: {
			useUTC: false
		},

		title: {
			text: 'Lobby',
			align: 'left',
			style: {"font-size": "200%", "color": "#676767"},
			margin: 0,
			x: 30
		},
		xAxis: {
			type: 'datetime',
			tickPixelInterval: 150
		},
		yAxis: {
			gridLineColor: '#ebebeb',
			title: {
				text: undefined
				/*text: 'Lobby',
				rotation: 0,
				margin: 60,
				style: {"font-family": "Helvetica, Arial, sans-serif", "font-size": "250%", "color": "#676767"}
				*/
			},
			plotLines: [{
				value: 0,
				width: 1,
				color: '#808080'
			}]

		},
		tooltip: {
			headerFormat: '<b>{series.name}</b><br/>',
			//pointFormat: '{point.x:%Y-%m-%d %H:%M:%S}<br/>{point.y:.2f}'
			pointFormat: '{point.x:%H:%M:%S}: {point.y:.2f}'
		},
		legend: {
			enabled: false
		},
		exporting: {
			enabled: false
		},
		plotOptions: {
			areaspline: {
				marker: {
					enabled: false
				},
			}
		},
		/* Initial Data */
		series: [{				
			name: 'Lobby',
			color: "#434348",
			fillOpacity: 0.2,
			data: (function () {
				// generate an array of random data
				var data = [],
					time = (new Date()).getTime(),
					i;

				for (i = -19; i <= 0; i += 1) {
					data.push({
						x: time + i * 1000,
						y: Math.random()
					});
				}
				return data;
			}())
		}]
	});
	
	/*Kitchen*/
	Highcharts.chart('container3', {
		chart: {
			type: 'areaspline',
			animation: Highcharts.svg, // don't animate in old IE
			marginRight: 10,
			/* Dynamic Data */
			events: {
				load: function () {

					// set up the updating of the chart each second
					var series = this.series[0];
					setInterval(function () {
						var x = (new Date()).getTime(), // current time
							y = y3;
						series.addPoint([x, y], true, true);
					}, 1000);
				}
			}
		},

		time: {
			useUTC: false
		},

		title: {
			text: 'Kitchen',
			align: 'left',
			style: {"font-size": "200%", "color": "#676767"},
			margin: 0,
			x: 30
		},
		xAxis: {
			type: 'datetime',
			tickPixelInterval: 150
		},
		yAxis: {
			gridLineColor: '#ebebeb',
			title: {
				text: undefined
				/*text: 'Kitchen',
				rotation: 0,
				margin: 60,
				style: {"font-family": "Helvetica, Arial, sans-serif", "font-size": "250%", "color": "#676767"}
				*/
			},
			plotLines: [{
				value: 0,
				width: 1,
				color: '#808080'
			}]

		},
		tooltip: {
			headerFormat: '<b>{series.name}</b><br/>',
			//pointFormat: '{point.x:%Y-%m-%d %H:%M:%S}<br/>{point.y:.2f}'
			pointFormat: '{point.x:%H:%M:%S}: {point.y:.2f}'
		},
		legend: {
			enabled: false
		},
		exporting: {
			enabled: false
		},
		plotOptions: {
			areaspline: {
				marker: {
					enabled: false
				},
			}
		},
		/* Initial Data */
		series: [{				
			name: 'Kitchen',
			color: "#77ee77",
			fillOpacity: 0.2,
			data: (function () {
				// generate an array of random data
				var data = [],
					time = (new Date()).getTime(),
					i;

				for (i = -19; i <= 0; i += 1) {
					data.push({
						x: time + i * 1000,
						y: Math.random()
					});
				}
				return data;
			}())
		}]
	});

	/* Remove credits */
	var x = document.getElementsByClassName("highcharts-credits");
	var j;
	for (j = 0; j < x.length; j++) {
		x[j].style.display = "none";
	}
	</script>
  
  </body>

</html>
